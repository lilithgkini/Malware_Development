#include <windows.h>
#include <tlhelp32.h>
#include <stdio.h>
#include "process.h"

int main(int argc, char *argv[]) {
  HANDLE hProcess, hThread = NULL;

  if (argc != 2) {
    warn("Use: %s Process_name", argv[0]);
    return -1;
  }
  char *name = argv[1];

  if (get_process(&hProcess, name) == -1) {
    warn("failed to find the process %s", name);
    return -1;
  }

  okey("Found process! %p", hProcess);

  if (process_inject(hProcess) == -1) {
    warn("Failed to inject shellcode to process. Error: %ld",GetLastError());
    CloseHandle(hProcess);
    return -1;
  }

  info("End of the program");
  CloseHandle(hProcess);
  return 0;
}
